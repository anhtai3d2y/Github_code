if (self.CavalryLogger) { CavalryLogger.start_js(["WcoQ+"]); }

__d("XCometMessengerPhotoControllerRouteBuilder",["cometRouteBuilder"],(function(a,b,c,d,e,f){a=b("cometRouteBuilder")("/messenger_photo/",Object.freeze({}),void 0);e.exports=a}),null);
__d("MWChatPhotoRootQuery.graphql",["RelayHooks"],(function(a,b,c,d,e,f){"use strict";a=b("RelayHooks").PreloadableQueryRegistry;c=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"attachment_id",type:"ID!"},{defaultValue:null,kind:"LocalArgument",name:"message_id",type:"ID!"}],b=[{kind:"Variable",name:"attachment_id",variableName:"attachment_id"},{kind:"Variable",name:"message_id",variableName:"message_id"}],c={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Literal",name:"site",value:"www"}],kind:"ScalarField",name:"url",storageKey:'url(site:"www")'}],type:"MessageImage",abstractKey:null},d={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:null}],type:"MessageAnimatedImage",abstractKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"MWChatPhotoRootQuery",selections:[{alias:"currMedia",args:b,concreteType:null,kind:"LinkedField",name:"message_attachment",plural:!1,selections:[c,d],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"MWChatPhotoRootQuery",selections:[{alias:"currMedia",args:b,concreteType:null,kind:"LinkedField",name:"message_attachment",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c,d,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Node",abstractKey:"__isNode"}],storageKey:null}]},params:{id:"2995535170541108",metadata:{relayPreloadable:!0},name:"MWChatPhotoRootQuery",operationKind:"query",text:null}}}();c.params.id!=null&&a.set(c.params.id,c);e.exports=c}),null);
__d("messengerWebMediaViewerPrefetch",["CometRelay","promiseDone","relay-runtime"],(function(a,b,c,d,e,f){"use strict";var g=b("CometRelay").fetchQuery,h=b("relay-runtime").createOperationDescriptor,i=b("relay-runtime").getRequest;e.exports=function(a,c,d){c=h(i(a),c);var e=d.check(c)==="available";e||b("promiseDone")(g(d,a,c.request.variables).toPromise())}}),null);
__d("MWChatPhotoRoot.react",["CometContentNotAvailable.react","CometImage.react","CometMediaViewerLayoutSkeleton.react","CometMediaViewerStage.react","CometPhotoViewerInnerWrapper.react","CometPlaceholder.react","CometRelay","CometRouteParams","CometRouteRenderType","CometTrackingNodeProvider.react","MWChatDeleteMessageEventEmitter","React","XCometMessengerPhotoControllerRouteBuilder","messengerWebMediaViewerPrefetch","unrecoverableViolation","useCometRouterDispatcher","useRoutePassthroughProps","MWChatPhotoRootQuery.graphql"],(function(a,b,c,d,e,f){"use strict";var g,h=b("CometPhotoViewerInnerWrapper.react").CometPhotoViewerImageWrapper,i=b("CometPhotoViewerInnerWrapper.react").CometPhotoViewerPlaceholderWrapper,j=b("CometPhotoViewerInnerWrapper.react").useCometPhotoViewerContainerStyles,k=b("CometRelay").usePreloadedQuery;b("CometRelay").graphql;var l=b("CometRelay").useRelayEnvironment,m=b("CometRouteParams").useRouteParams,n=b("CometRouteRenderType").useIsPushView,o=b("React");c=b("React");var p=c.useEffect,q=g!==void 0?g:g=b("MWChatPhotoRootQuery.graphql");function r(a){var c,d=a.currentPhotoID,e=a.messageID,f=a.messengerPhotoRootQueryReference,g=a.photoIDs;a=k(q,f);f=j();var i=(a==null?void 0:(c=a.currMedia)==null?void 0:c.url)||(a==null?void 0:(c=a.currMedia)==null?void 0:(a=c.image)==null?void 0:a.uri);c=null;a=null;var l=function(a){return a!=null?b("XCometMessengerPhotoControllerRouteBuilder").buildURL({fbid:a,message_id:e,photo_ids:g}):null};if(Array.isArray(g)&&g.length>0){var m=g.findIndex(function(a){return a===d});m!==-1&&(c=m-1>-1?l(g[m-1]):null,a=m+1<g.length?l(g[m+1]):null)}return i!=null?o.jsx(b("CometMediaViewerLayoutSkeleton.react"),{children:o.jsx(b("CometMediaViewerStage.react"),{backgroundSrc:i,nextMediaURI:a,prevMediaURI:c,children:o.jsx("div",{className:f,children:o.jsx(h,{imageComponent:function(a){return o.jsx(b("CometImage.react"),{className:a,src:i,testid:void 0},i)}})})})}):o.jsx(b("CometMediaViewerLayoutSkeleton.react"),{children:o.jsx(b("CometMediaViewerStage.react"),{nextMediaURI:a,prevMediaURI:c,children:o.jsx("div",{className:f,children:o.jsx(b("CometContentNotAvailable.react"),{})})})})}function a(a){var c=m(),d=b("useRoutePassthroughProps")(),e=b("useCometRouterDispatcher")(),f=n();d=(d==null?void 0:d.origSrc)!=null?String(d==null?void 0:d.origSrc):null;var g=c==null?void 0:c.fbid,h=[];Array.isArray(c.photo_ids)&&(h=c.photo_ids.map(function(a){return String(a)}));var j=c==null?void 0:c.message_id,k=l();p(function(){Array.isArray(c.photo_ids)&&c.photo_ids.forEach(function(a){a!=null&&b("messengerWebMediaViewerPrefetch")(q,{attachment_id:String(a),message_id:String(j)},k)})},[k,c.photo_ids,j]);if(g==null||typeof g!=="string")throw b("unrecoverableViolation")("Invalid fbid parameter","comet_ui");if(j==null||typeof j!=="string")throw b("unrecoverableViolation")("Invalid messageID parameter","messenger_web_product");p(function(){var a=b("MWChatDeleteMessageEventEmitter").subscribe(function(a){a===j&&k.commitUpdate(function(a){var b=a.getRoot();if(b==null)return;Array.isArray(c.photo_ids)?c.photo_ids.forEach(function(a){b.setValue(null,"message_attachment",{attachment_id:a,message_id:j})}):b.setValue(null,"message_attachment",{attachment_id:g,message_id:j});e!=null&&f&&e.popPushView()})});return a},[k,f,j,g,c.photo_ids,e]);var s=d!=null&&d!==""?{backgroundSrc:d}:null;return o.jsx(b("CometTrackingNodeProvider.react"),{trackingNode:82,children:o.jsx(b("CometPlaceholder.react"),{fallback:o.jsx(b("CometMediaViewerLayoutSkeleton.react"),{children:o.jsx(b("CometMediaViewerStage.react"),babelHelpers["extends"]({},s,{useKeyCommands:!1,children:o.jsx(i,{imageUri:d,showPlaceholderImage:d!=null})}))}),children:o.jsx(r,babelHelpers["extends"]({currentPhotoID:g,messageID:j,photoIDs:h},a.queries))})})}e.exports=a}),null);