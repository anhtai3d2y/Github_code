if (self.CavalryLogger) { CavalryLogger.start_js(["vVMbS"]); }

__d("MWChatMediaRootQuery.graphql",["RelayHooks"],(function(a,b,c,d,e,f){"use strict";a=b("RelayHooks").PreloadableQueryRegistry;c=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"threadID",type:"ID!"},{defaultValue:null,kind:"LocalArgument",name:"messageID",type:"ID"},{defaultValue:null,kind:"LocalArgument",name:"after",type:"ID"},{defaultValue:null,kind:"LocalArgument",name:"first",type:"Int"},{defaultValue:null,kind:"LocalArgument",name:"before",type:"ID"},{defaultValue:null,kind:"LocalArgument",name:"last",type:"Int"},{defaultValue:null,kind:"LocalArgument",name:"scale",type:"Float!"}],b=[{kind:"Variable",name:"id",variableName:"threadID"}],c={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},d=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"before",variableName:"before"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"last",variableName:"last"},{kind:"Variable",name:"message_id",variableName:"messageID"},{kind:"Literal",name:"message_shared_media_type",value:"PHOTO_AND_VIDEO"}],e={alias:null,args:null,kind:"ScalarField",name:"message_id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"timestamp_precise",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"legacy_attachment_id",storageKey:null},i={alias:null,args:[{kind:"Literal",name:"height",value:2048},{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"width",value:2048}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"downloadable_uri",storageKey:null}],storageKey:null},j={kind:"InlineFragment",selections:[h,{alias:null,args:null,kind:"ScalarField",name:"blurred_image_uri",storageKey:null},i],type:"MessageImage",abstractKey:null};h={kind:"InlineFragment",selections:[h,{alias:"sdUrl",args:[{kind:"Literal",name:"quality",value:"SD"}],kind:"ScalarField",name:"playable_url",storageKey:'playable_url(quality:"SD")'},{alias:"hdUrl",args:[{kind:"Literal",name:"quality",value:"HD"}],kind:"ScalarField",name:"playable_url",storageKey:'playable_url(quality:"HD")'},i,{alias:null,args:null,concreteType:"Vect2",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null}],storageKey:null}],type:"MessageVideo",abstractKey:null};i={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null};var k={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"page_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_next_page",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"has_previous_page",storageKey:null}],storageKey:null},l={kind:"InlineFragment",selections:[c],type:"Node",abstractKey:"__isNode"};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"MWChatMediaRootQuery",selections:[{alias:null,args:b,concreteType:"MessageThread",kind:"LinkedField",name:"message_thread",plural:!1,selections:[c,{alias:null,args:d,concreteType:"MessagesWithAttachmentsOfThreadConnection",kind:"LinkedField",name:"messages_with_attachments",plural:!1,selections:[{alias:null,args:null,concreteType:"MessagesWithAttachmentsOfThreadEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[e,c,f,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"blob_attachments",plural:!0,selections:[g,j,h],storageKey:null}],type:"UserMessage",abstractKey:null}],storageKey:null},i],storageKey:null},k],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"MWChatMediaRootQuery",selections:[{alias:null,args:b,concreteType:"MessageThread",kind:"LinkedField",name:"message_thread",plural:!1,selections:[c,{alias:null,args:d,concreteType:"MessagesWithAttachmentsOfThreadConnection",kind:"LinkedField",name:"messages_with_attachments",plural:!1,selections:[{alias:null,args:null,concreteType:"MessagesWithAttachmentsOfThreadEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,{kind:"InlineFragment",selections:[e,c,f,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"blob_attachments",plural:!0,selections:[g,j,h,l],storageKey:null}],type:"UserMessage",abstractKey:null},l],storageKey:null},i],storageKey:null},k],storageKey:null}],storageKey:null}]},params:{id:"2943836832390210",metadata:{relayPreloadable:!0},name:"MWChatMediaRootQuery",operationKind:"query",text:null}}}();c.params.id!=null&&a.set(c.params.id,c);e.exports=c}),null);
__d("MWChatMessageId.bs",["bs_block","bs_caml_format"],(function(a,b,c,d,e,f){"use strict";function a(a){if(typeof a==="number"||!a.tag)return;else return a[0].messageId}function c(a,c,d){return b("bs_block").__(1,[{threadId:b("bs_caml_format").caml_int64_of_string(a),messageId:c,timestamp:b("bs_caml_format").caml_int64_of_string(d)}])}function d(a){return b("bs_block").__(1,[{threadId:[0,0],messageId:a,timestamp:[0,0]}])}e=b("bs_block").__(1,[{threadId:[0,0],messageId:"",timestamp:[0,0]}]);f.getMessageId=a;f.makeSent=c;f.emptyForExamples=e;f.emptyForExamplesWithId=d}),null);
__d("MWChatMessageId.re",["bs_curry","MWChatMessageId.bs"],(function(a,b,c,d,e,f){a=function(a,c,d){a=b("bs_curry")._3(b("MWChatMessageId.bs").makeSent,a,c,d);return a};f.makeSent=a}),null);
__d("MWChatVideoPlayerControls.react",["React","VideoPlayerControlsContainerOverlay.react","VideoPlayerControlsGroups.react","VideoPlayerFullscreenControl.react","VideoPlayerHooks","VideoPlayerPlaybackControl.react","VideoPlayerPlaybackTimer.react","VideoPlayerScrubber.react","VideoPlayerVolumeControl.react","stylex","useVideoPlayerBigPlayButtonOverlay","useVideoPlayerDefaultControlsVisibility"],(function(a,b,c,d,e,f){"use strict";var g=b("React"),h=b("VideoPlayerHooks").useIsFullscreen,i=b("VideoPlayerHooks").usePaused;function j(a){return g.jsx("span",{className:"fi2e5rcv jk2qo03r",children:a.children})}function a(a){var c=b("useVideoPlayerDefaultControlsVisibility")(),d=c.isControlsVisible;c=c.onUserInteraction;var e=i();e=b("useVideoPlayerBigPlayButtonOverlay")({forceVisible:e});var f=e.bigPlayButtonElement;e=e.bigPlayButtonIsVisible;var k=h();d=d&&!e;e=g.jsx(b("VideoPlayerControlsContainerOverlay.react"),{isVisible:d,children:k?g.jsxs(g.Fragment,{children:[g.jsxs(b("VideoPlayerControlsGroups.react").Contracted,{children:[g.jsx(b("VideoPlayerPlaybackControl.react"),{}),g.jsx(b("VideoPlayerPlaybackTimer.react"),{})]}),g.jsx(b("VideoPlayerControlsGroups.react").Expanded,{children:g.jsx(b("VideoPlayerScrubber.react"),{onUserInteraction:c})}),g.jsxs(b("VideoPlayerControlsGroups.react").Contracted,{children:[g.jsx(b("VideoPlayerFullscreenControl.react"),{onUserInteraction:c}),g.jsx(b("VideoPlayerVolumeControl.react"),{onUserInteraction:c})]})]}):g.jsxs(g.Fragment,{children:[g.jsx(b("VideoPlayerControlsGroups.react").Contracted,{children:g.jsx(j,{children:g.jsx(b("VideoPlayerPlaybackControl.react"),{})})}),g.jsx(b("VideoPlayerControlsGroups.react").Expanded,{children:g.jsx(b("VideoPlayerScrubber.react"),{onUserInteraction:c})}),g.jsxs(b("VideoPlayerControlsGroups.react").Contracted,{children:[a.hideExpandButton?null:g.jsx(j,{children:g.jsx(b("VideoPlayerFullscreenControl.react"),{onUserInteraction:c})}),g.jsx(j,{children:g.jsx(b("VideoPlayerVolumeControl.react"),{onUserInteraction:c})})]})]})});return g.jsxs(g.Fragment,{children:[f,e]})}e.exports=a}),null);
__d("VideoPlayerX.react",["React","VideoPlayerFallbackCover.react","VideoPlayerRetryableErrorBoundary.react","VideoPlayerXImpl.react"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function h(a){a=a.retry;return g.jsx(b("VideoPlayerFallbackCover.react"),{onRetry:a})}function a(a){var c=a.doNotRenderErrorBoundaryIUnderstandIMustProvideMyOwn;c=c===void 0?!1:c;var d=a.errorBoundaryFallback;a=babelHelpers.objectWithoutPropertiesLoose(a,["doNotRenderErrorBoundaryIUnderstandIMustProvideMyOwn","errorBoundaryFallback"]);a=g.jsx(b("VideoPlayerXImpl.react"),babelHelpers["extends"]({VideoPlayerShakaPerformanceLoggerClass:null},a));return c?a:g.jsx(b("VideoPlayerRetryableErrorBoundary.react"),{description:"VideoPlayerX",fallback:(c=d)!=null?c:h,children:a})}e.exports=a}),null);
__d("MWChatVideoPlayer.react",["GraphQLVideoAutoplayGatingResult","MWChatVideoAutoplaySettingContext","MWChatVideoPlayerControls.react","React","VideoPlayerDefaultControls.react","VideoPlayerProgressiveImplementationData","VideoPlayerProgressiveImplementationV2.react","VideoPlayerSurface.react","VideoPlayerX.react","getVideoPlayerAutoplayProps"],(function(a,b,c,d,e,f){"use strict";var g=b("GraphQLVideoAutoplayGatingResult").makeGraphQLVideoAutoplayGatingResult,h=b("MWChatVideoAutoplaySettingContext").useMWChatVideoAutoplaySetting,i=b("React"),j=b("VideoPlayerProgressiveImplementationData").makeProgressiveImplementationData;function a(a){var c=a.fbid,d=a.hdSrc,e=a.hideExpandButton,f=a.initialForceHD,k=a.originalHeight,l=a.originalWidth,m=a.sdSrc;a=a.useDefaultControls;f=j({hdSrc:d,hdSrcPreferred:(d=f)!=null?d:!1,sdSrc:m});d=h();if(f==null)return null;m=[{Component:b("VideoPlayerProgressiveImplementationV2.react"),data:f,typename:"VideoPlayerProgressiveImplementation"}];f=b("getVideoPlayerAutoplayProps")(g("unknown",d,!0),"respect_user_settings",null);return i.jsx(b("VideoPlayerX.react"),babelHelpers["extends"]({},f,{implementations:m,loopCount:-1,originalHeight:k,originalWidth:l,playerOriginOverride:"messaging",portalingEnabled:!1,subOrigin:"messenger_thread",videoFBID:c,children:i.jsx(b("VideoPlayerSurface.react"),{children:a===!0?i.jsx(b("VideoPlayerDefaultControls.react"),{}):i.jsx(b("MWChatVideoPlayerControls.react"),{hideExpandButton:e===!0})})}))}e.exports=a}),null);
__d("MWChatMediaData",[],(function(a,b,c,d,e,f){"use strict";var g=function(a){return a==null||a.__typename!=="MessageVideo"||a.sdUrl==null||a.image==null||a.image.uri==null||a.image.width==null||a.image.height==null||a.original_dimensions==null||a.original_dimensions.x==null||a.original_dimensions.y==null?null:{hdUrl:a.hdUrl,image:{downloadableUri:a.image.downloadable_uri,height:a.image.height,uri:a.image.uri,width:a.image.width},legacyAttachmentID:a.legacy_attachment_id,originalDimensions:{x:a.original_dimensions.x,y:a.original_dimensions.y},sdUrl:a.sdUrl}},h=function(a){return a==null||a.__typename!=="MessageImage"||a.image==null||a.image.uri==null||a.image.width==null||a.image.height==null?null:{blurredImageUri:a.blurred_image_uri,image:{downloadableUri:a.image.downloadable_uri,height:a.image.height,uri:a.image.uri,width:a.image.width},legacyAttachmentID:a.legacy_attachment_id}};a=function(a){return a.reduce(function(a,b){if(b==null||b.node==null||b.node.id==null||b.node.message_id==null||b.node.blob_attachments==null||b.cursor==null)return a;var c=b.node,d=c.blob_attachments,e=c.id,f=c.message_id,i=c.timestamp_precise,j=b.cursor;c=d.map(function(a){if(a.__typename==="MessageImage"){var b=h(a);return b==null?null:{__typename:"MessageImage",attachment:b,cursor:j,messageID:f,nodeID:e,timestamp:i}}else if(a.__typename==="MessageVideo"){b=g(a);return b==null?null:{__typename:"MessageVideo",attachment:b,cursor:j,messageID:f,nodeID:e,timestamp:i}}else return null}).filter(Boolean);return a.concat(c)},[]).filter(Boolean)};e.exports={normalizeMessages:a}}),null);
__d("MWChatMediaReducer",[],(function(a,b,c,d,e,f){"use strict";a={curIdx:0,hasNextPage:!1,hasPrevPage:!1,initialCursor:null,isFetchingNextPage:!1,isFetchingPrevPage:!1,mediaList:[]};b=function(a,b){switch(b.type){case"initialize":return babelHelpers["extends"]({},a,{curIdx:b.curIdx,initialCursor:b.initialCursor,mediaList:b.mediaList});case"startFetchingNextPage":return babelHelpers["extends"]({},a,{isFetchingNextPage:!0});case"startFetchingPrevPage":return babelHelpers["extends"]({},a,{isFetchingPrevPage:!0});case"prevPageReceived":return babelHelpers["extends"]({},a,{curIdx:a.curIdx+b.medias.length,hasPrevPage:b.hasPrevPage,isFetchingPrevPage:!1,mediaList:b.medias.concat(a.mediaList)});case"nextPageReceived":return babelHelpers["extends"]({},a,{hasNextPage:b.hasNextPage,isFetchingNextPage:!1,mediaList:a.mediaList.concat(b.medias)});case"messageDeleted":return babelHelpers["extends"]({},a,{curIdx:Math.min(Math.max(b.curIdx,0),a.mediaList.length-1),mediaList:b.mediaList});case"viewMediaAtIndex":return babelHelpers["extends"]({},a,{curIdx:Math.min(Math.max(b.curIdx,0),a.mediaList.length-1)});default:return a}};e.exports={initialState:a,reducer:b}}),null);
__d("MWChatMediaViewerImage.react",["fbt","CometHero.react","CometPagelet.react","CometPhotoViewerImageSuspense","CometPhotoViewerInnerWrapper.react","CometPressable.react","React"],(function(a,b,c,d,e,f,g){"use strict";var h=b("CometPhotoViewerInnerWrapper.react").CometPhotoViewerImageWrapper,i=b("CometPhotoViewerInnerWrapper.react").CometPhotoViewerPlaceholderWrapper,j=b("CometPhotoViewerInnerWrapper.react").useCometPhotoViewerContainerStyles,k=b("React");c=b("React");var l=c.useState,m=g._("Kh\u00f4ng c\u00f3 m\u00f4 t\u1ea3.");function a(a){var c=a.blurredImageURI,d=a.imageURI,e=a.origHeight,f=a.origSrc;a=a.origWidth;var n=l(!1),o=n[0],p=n[1];n=j(!0);return k.jsxs(b("CometPagelet.react").Placeholder,{className:n,fallback:f!=null?k.jsx(i,{height:e,imageUri:f,showPlaceholderImage:f!=null&&a!=null&&e!=null,width:a,withFooter:!0}):null,name:"MessengerMediaViewerPhoto",pageletType:"media",children:[k.jsx(b("CometHero.react"),{description:"MWChatMediaViewerImage"}),c==null||o?k.jsx(h,{imageComponent:function(a){return k.jsx(b("CometPhotoViewerImageSuspense"),{alt:m,className:a,src:d},d)},withFooter:!0}):k.jsx(b("CometPressable.react"),{display:"inline",label:g._("Nh\u1ea5n \u0111\u1ec3 xem n\u1ed9i dung nh\u1ea1y c\u1ea3m"),onPress:function(){return p(!0)},children:k.jsx(h,{imageComponent:function(a){return k.jsx(b("CometPhotoViewerImageSuspense"),{alt:m,className:a,src:c},c)},withFooter:!0})})]},d)}e.exports=a}),null);
__d("MWChatMediaViewerStage.react",["ix","fbt","requireDeferred","CometBlurredBackgroundImage.react","CometKeys","CometMediaViewerFilmstrip.react","CometTrackingNodeProvider.react","Locale","React","TetraCircleButton.react","deferredLoadComponent","fbicon","gkx","stylex","useLayerKeyCommands"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React");c=b("React");var j=c.useMemo,k=b("deferredLoadComponent")(b("requireDeferred")("MWChatMediaViewerControls.react"));function a(a){var c=a.activeIndex,d=a.attachmentID,e=a.backgroundSrc,f=a.children,l=a.disableNextButton,m=a.disablePrevButton,n=a.downloadLink,o=a.hideNextButton,p=a.hidePrevButton,q=a.messageID,r=a.setActiveIndex,s=h._("\u1ea2nh tr\u01b0\u1edbc \u0111\u00f3"),t=h._("\u1ea2nh ti\u1ebfp theo"),u=j(function(){var c=[];!p&&!m&&c.push({command:{key:b("CometKeys").LEFT},description:s,handler:function(){return r(a.activeIndex-1)}});!o&&!l&&c.push({command:{key:b("CometKeys").RIGHT},description:t,handler:function(){return r(a.activeIndex+1)}});return c},[l,m,o,p,t,s,a.activeIndex,r]);b("useLayerKeyCommands")(u);u=b("gkx")("1435437");return i.jsxs("div",{className:"iqfcb0g7 abiwlrkh l9j0dhe7 p01isnhg datstx6m buofh1pr cbu4d94t j83agx80 tqsryivl bp9cbjyn",ref:function(a){a&&a.focus()},tabIndex:"0",children:[i.jsx("div",{className:"kr520xx4 j9ispegn pmk7jnqg akz8cqyu n7fi1qx3 i09qtzwb",children:e!=null?i.jsx(b("CometBlurredBackgroundImage.react"),{src:e}):null}),i.jsxs("div",{className:"k4urcfbm l9j0dhe7 j0qtgc86 e9n865no taijpn5t datstx6m buofh1pr j83agx80 rq0escxv",children:[u&&d!=null&&q!=null?i.jsx("div",{className:"tkr6xdv7 pmk7jnqg byvelhso oxoulkyr j83agx80 bp9cbjyn",children:i.jsx(k,{attachmentID:d,downloadLink:n,messageID:q})}):null,i.jsxs("div",{className:"kr520xx4 j9ispegn pmk7jnqg i1fnvgqd n7fi1qx3 j83agx80 i09qtzwb bp9cbjyn",children:[i.jsx("div",{className:"dhix69tm sjgh65i0 wkznzc2l tr9rh885"+(p?" kr9hpln1":""),children:i.jsx(b("CometTrackingNodeProvider.react"),{trackingNode:143,children:i.jsx(b("TetraCircleButton.react"),{color:"secondary",disabled:m,icon:b("Locale").isRTL()?b("fbicon")._(g("492539"),24):b("fbicon")._(g("492491"),24),label:s,onPress:function(){return r(c-1)},size:48,testid:void 0,type:"overlay"})})}),i.jsx("div",{className:"dhix69tm sjgh65i0 wkznzc2l tr9rh885"+(o?" kr9hpln1":""),children:i.jsx(b("CometTrackingNodeProvider.react"),{trackingNode:142,children:i.jsx(b("TetraCircleButton.react"),{color:"secondary",disabled:l,icon:b("Locale").isRTL()?b("fbicon")._(g("492491"),24):b("fbicon")._(g("492539"),24),label:t,onPress:function(){return r(c+1)},size:48,testid:void 0,type:"overlay"})})})]}),f]}),i.jsx("div",{className:"stjgntxs ni8dbmo4 d2edcug0",children:i.jsx(b("CometMediaViewerFilmstrip.react"),{activeIndex:c,images:a.thumbnails,onSetImage:r})})]})}e.exports=a}),null);
__d("MWChatMediaViewerVideo.react",["CometRouteRenderType","MWChatVideoPlayer.react","React","stylex"],(function(a,b,c,d,e,f){"use strict";var g,h=b("CometRouteRenderType").useIsPushView,i=b("React");function a(a){var c=h();return i.jsx("div",{className:(g||(g=b("stylex"))).dedupe({"align-items-1":"bp9cbjyn","display-1":"j83agx80","flex-grow-1":"buofh1pr","justify-content-1":"taijpn5t","min-height-1":"pnzxbu4t","width-1":"k4urcfbm"},c?{"height-1":"n626y76b"}:null,c?null:{"height-1":"ojb6a8i8"}),children:i.jsx(b("MWChatVideoPlayer.react"),{fbid:a.fbid,hdSrc:a.hdSrc,initialForceHD:!0,originalHeight:a.originalHeight,originalWidth:a.originalWidth,sdSrc:a.sdSrc,useDefaultControls:!0})})}e.exports=a}),null);
__d("MWChatMediaRoot.react",["fbt","requireCond","CometContentNotAvailable.react","CometErrorBoundary.react","CometErrorRoot.react","CometRelay","CometRouteParams","MWChatDeleteMessageEventEmitter","MWChatMediaData","MWChatMediaReducer","MWChatMediaViewerImage.react","MWChatMediaViewerStage.react","MWChatMediaViewerVideo.react","MWChatMessageId.re","cr:1485119","React","WebPixelRatio","useIsMountedRef","MWChatMediaRootQuery.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(c=b("CometRelay")).fetchQuery;c.graphql;var j=c.usePreloadedQuery,k=c.useRelayEnvironment,l=b("CometRouteParams").useRouteParams,m=b("MWChatMediaData").normalizeMessages,n=b("MWChatMediaReducer").initialState,o=b("MWChatMediaReducer").reducer,p=b("MWChatMessageId.re").makeSent,q=b("React");d=b("React");var r=d.useCallback,s=d.useEffect,t=d.useReducer,u=d.useState,v=20,w=h!==void 0?h:h=b("MWChatMediaRootQuery.graphql");function x(a){var c=k(),d=l(),e=u(null),f=e[0],h=e[1];e=t(o,n);var x=e[0],y=x.curIdx,z=x.hasNextPage,A=x.hasPrevPage,B=x.initialCursor,C=x.isFetchingNextPage,D=x.isFetchingPrevPage,E=x.mediaList,F=e[1],G=b("useIsMountedRef")(),H=j(w,a.queries.messengerMediaRootQueryReference);if(f!==null)throw f;s(function(){var a;a=H==null?void 0:(a=H.message_thread)==null?void 0:(a=a.messages_with_attachments)==null?void 0:(a=a.edges[0])==null?void 0:a.cursor;if(a!=null&&B===null){var b;b=H==null?void 0:(b=H.message_thread)==null?void 0:(b=b.messages_with_attachments)==null?void 0:b.edges;if(b!=null){b=m(b);var c=0;d.attachment_id!=null&&(c=b.findIndex(function(a){return a.attachment.legacyAttachmentID===d.attachment_id}));F({curIdx:c,initialCursor:a,mediaList:b,type:"initialize"})}}},[B,H,d.attachment_id]);var I=H==null?void 0:(x=H.message_thread)==null?void 0:x.id;s(function(){var a=b("MWChatDeleteMessageEventEmitter").subscribe(function(a){var b=y,d=E.filter(function(c,d){c=c.messageID===a;c&&(d<=y&&y>0&&b--);return!c});d.length!==E.length&&(I!=null&&c.commitUpdate(function(a){return(a=a.get(I))==null?void 0:a.invalidateRecord()}));F({curIdx:b,mediaList:d,type:"messageDeleted"})});return a},[c,I,y,E]);var J=r(function(a){F({type:"startFetchingPrevPage"});return i(c,w,{before:a,last:v,scale:b("WebPixelRatio").get(),threadID:d.thread_id}).toPromise().then(function(a){var b;if(!G.current)return;a=a==null?void 0:(a=a.message_thread)==null?void 0:a.messages_with_attachments;b=m((b=a==null?void 0:a.edges)!=null?b:[]);if(b.length>0){F({hasPrevPage:(a=a==null?void 0:(a=a.page_info)==null?void 0:a.has_previous_page)!=null?a:!1,medias:b,type:"prevPageReceived"})}})["catch"](function(a){if(!G.current)return;h(a)})},[c,G,d.thread_id]),K=r(function(a){F({type:"startFetchingNextPage"});return i(c,w,{after:a,first:v,scale:b("WebPixelRatio").get(),threadID:d.thread_id}).toPromise().then(function(a){var b;if(!G.current)return;a=a==null?void 0:(a=a.message_thread)==null?void 0:a.messages_with_attachments;b=m((b=a==null?void 0:a.edges)!=null?b:[]);if(b.length>0){F({hasNextPage:(a=a==null?void 0:(a=a.page_info)==null?void 0:a.has_next_page)!=null?a:!1,medias:b,type:"nextPageReceived"})}})["catch"](function(a){if(!G.current)return;h(a)})},[c,G,d.thread_id]);s(function(){B!=null&&(K(B),J(B))},[c,K,J,B,d.thread_id]);var L=(a=(e=E[0])==null?void 0:e.cursor)!=null?a:null,M=(x=(f=E[E.length-1])==null?void 0:f.cursor)!=null?x:null;s(function(){y<=v/2&&A&&!D&&L!=null?J(L):y>=E.length-v/2&&z&&!C&&M!=null&&K(M)},[y,J,K,z,A,L,M,E.length,C,D]);e=E[y];if(B==null)return null;if(e==null)return q.jsx(b("CometContentNotAvailable.react"),{});a=E.map(function(a){var b=a.attachment.image,c=b.height,d=b.uri;b=b.width;return{alt:g._("Kh\u00f4ng c\u00f3 m\u00f4 t\u1ea3."),height:c,key:(c=a.attachment.legacyAttachmentID)!=null?c:d,uri:d,width:b}}).filter(Boolean);return q.jsx(b("MWChatMediaViewerStage.react"),{activeIndex:y,attachmentID:e.attachment.legacyAttachmentID,backgroundSrc:e.attachment.image.uri,disableNextButton:C&&E[y+1]==null,disablePrevButton:D&&E[y-1]==null,downloadLink:e.attachment.image.downloadableUri,hideNextButton:!z&&E[y+1]==null,hidePrevButton:!A&&E[y-1]==null,messageID:typeof d.thread_id==="string"&&e.timestamp!=null?p(d.thread_id,e.messageID,e.timestamp):null,setActiveIndex:function(a){return F({curIdx:a,type:"viewMediaAtIndex"})},thumbnails:a,children:e.__typename==="MessageVideo"?q.jsx(b("MWChatMediaViewerVideo.react"),{fbid:e.nodeID,hdSrc:e.attachment.hdUrl!=null?e.attachment.hdUrl:void 0,originalHeight:e.attachment.originalDimensions.x,originalWidth:e.attachment.originalDimensions.y,sdSrc:e.attachment.sdUrl}):e.__typename==="MessageImage"?q.jsx(b("MWChatMediaViewerImage.react"),{blurredImageURI:e.attachment.blurredImageUri,imageURI:e.attachment.image.uri}):null})}function a(a){a=q.jsx(x,babelHelpers["extends"]({},a));return q.jsx(b("CometErrorBoundary.react"),{fallback:function(){return q.jsx(b("CometErrorRoot.react"),{})},children:b("cr:1485119")==null?a:q.jsx(b("cr:1485119"),{children:a})})}e.exports=a}),null);